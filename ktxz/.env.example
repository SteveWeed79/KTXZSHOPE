# =============================================================================
# KTXZ TCG Marketplace - Environment Variables
# =============================================================================
# Copy this file to .env.local and fill in the values.
# Variables marked [REQUIRED] must be set for the app to start.
# Variables marked [OPTIONAL] enable additional features.

# --- Database ---
MONGODB_URI=               # [REQUIRED] MongoDB connection string (e.g. mongodb+srv://user:pass@cluster.mongodb.net/ktxz)

# --- Authentication ---
NEXTAUTH_SECRET=           # [REQUIRED] Random secret for signing JWTs (generate with: openssl rand -base64 32)
NEXTAUTH_URL=              # [OPTIONAL] Base URL for NextAuth callbacks (defaults to http://localhost:3000)

# --- Stripe ---
STRIPE_SECRET_KEY=         # [REQUIRED] Stripe secret key (sk_test_... or sk_live_...)
STRIPE_WEBHOOK_SECRET=     # [REQUIRED] Stripe webhook signing secret (whsec_...)

# --- Admin ---
ADMIN_EMAIL=               # [OPTIONAL] Email address that always has admin access (bypasses DB role check)

# --- Google OAuth (optional) ---
AUTH_GOOGLE_ID=            # [OPTIONAL] Google OAuth client ID (required for Google sign-in)
AUTH_GOOGLE_SECRET=        # [OPTIONAL] Google OAuth client secret

# --- Email (optional - enables password resets & order confirmations) ---
RESEND_API_KEY=            # [OPTIONAL] Resend API key for sending emails
EMAIL_FROM=                # [OPTIONAL] Sender email address (defaults to onboarding@resend.dev)
EMAIL_FROM_NAME=           # [OPTIONAL] Sender display name (defaults to KTXZ)

# --- Site URL ---
SITE_URL=                  # [OPTIONAL] Public site URL, fallback for NEXTAUTH_URL
NEXT_PUBLIC_SITE_URL=      # [OPTIONAL] Public site URL accessible on client side

# --- Rate Limiting (Redis) ---
# Without these, rate limiting falls back to a per-instance in-memory Map,
# which provides no protection when multiple serverless workers are running.
# Create a free Redis database at console.upstash.com and copy the REST URL/token.
UPSTASH_REDIS_REST_URL=    # [RECOMMENDED] Upstash Redis REST URL  (https://<db>.upstash.io)
UPSTASH_REDIS_REST_TOKEN=  # [RECOMMENDED] Upstash Redis REST token

# --- Shippo (shipping label creation) ---
# Enables GET /api/admin/orders/[id]/label (rate quotes) and
# POST /api/admin/orders/[id]/label (label purchase + tracking number).
# Get your API key from app.goshippo.com → Settings → API.
SHIPPO_API_KEY=            # [OPTIONAL] Shippo API token (required for label purchasing)
SHIPPO_FROM_NAME=          # [OPTIONAL] Shipper name shown on labels
SHIPPO_FROM_STREET=        # [OPTIONAL] Shipper street address
SHIPPO_FROM_CITY=          # [OPTIONAL] Shipper city
SHIPPO_FROM_STATE=         # [OPTIONAL] Shipper 2-letter state (e.g. CA)
SHIPPO_FROM_ZIP=           # [OPTIONAL] Shipper ZIP code
SHIPPO_FROM_COUNTRY=       # [OPTIONAL] Shipper country code (default: US)
SHIPPO_FROM_PHONE=         # [OPTIONAL] Shipper phone (recommended for some carriers)
SHIPPO_FROM_EMAIL=         # [OPTIONAL] Shipper email

# --- S3 Image Storage ---
# Used by /api/admin/upload-url to generate presigned PUT URLs so admins can
# upload card images directly from the browser to S3 (no data passes through
# the Next.js server). See lib/s3.ts.
#
# Minimum IAM policy needed:
#   s3:PutObject on arn:aws:s3:::<bucket>/cards/*
#
# Bucket CORS must allow PUT from your domain:
#   AllowedOrigins: ["https://yourdomain.com"]
#   AllowedMethods: ["PUT"]
#   AllowedHeaders: ["content-type"]
#
AWS_REGION=                # [REQUIRED for uploads] AWS region (e.g. us-east-1)
AWS_S3_BUCKET=             # [REQUIRED for uploads] S3 bucket name
AWS_ACCESS_KEY_ID=         # [REQUIRED for uploads] IAM access key ID
AWS_SECRET_ACCESS_KEY=     # [REQUIRED for uploads] IAM secret access key
AWS_CLOUDFRONT_DOMAIN=     # [RECOMMENDED] CloudFront distribution domain (e.g. d1abc.cloudfront.net)
                           # If set, public image URLs use CloudFront instead of direct S3.
                           # Also used to lock down next/image remotePatterns and CSP.

# --- Cron Jobs ---
CRON_SECRET=               # [OPTIONAL] Secret for authorizing /api/cron/* endpoints
